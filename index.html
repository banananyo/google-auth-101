<html lang="en">

<head>
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id"
        content="904195872691-59fcln5nh2ciuemup8m2e754qsaa01r2.apps.googleusercontent.com">
    <!-- <script src="https://apis.google.com/js/platform.js" async defer></script> -->
</head>

<body>
    <div id="auth"><div id="my-signin2"></div></div>
    <a href="#" onclick="signOut();">Sign out</a>
    <script>
        var auth2;
        var googleUser;
        var appStart = function() {
        gapi.load('auth2', initSigninV2);
        };
        var initSigninV2 = function() {
        auth2 = gapi.auth2.init({
            client_id: '904195872691-59fcln5nh2ciuemup8m2e754qsaa01r2.apps.googleusercontent.com',
            scope: 'profile'
        });
        auth2.isSignedIn.listen(signinChanged);
        auth2.currentUser.listen(userChanged);
        if (auth2.isSignedIn.get() == true) {
            auth2.signIn();
        }
        refreshValues();
        };

        var signinChanged = function (val) {
        console.log('Signin state changed to ', val);
        document.getElementById('signed-in-cell').innerText = val;
        };

        var userChanged = function (user) {
        console.log('User now: ', user);
        googleUser = user;
        updateGoogleUser();
        document.getElementById('curr-user-cell').innerText =
            JSON.stringify(user, undefined, 2);
        };

        var updateGoogleUser = function () {
        if (googleUser) {
            document.getElementById('user-id').innerText = googleUser.getId();
            document.getElementById('user-scopes').innerText =
            googleUser.getGrantedScopes();
            document.getElementById('auth-response').innerText =
            JSON.stringify(googleUser.getAuthResponse(), undefined, 2);
        } else {
            document.getElementById('user-id').innerText = '--';
            document.getElementById('user-scopes').innerText = '--';
            document.getElementById('auth-response').innerText = '--';
        }
        };

        var refreshValues = function() {
            if (auth2){
                console.log('Refreshing values...');

                googleUser = auth2.currentUser.get();

                document.getElementById('curr-user-cell').innerText =
                JSON.stringify(googleUser, undefined, 2);
                document.getElementById('signed-in-cell').innerText =
                auth2.isSignedIn.get();

                updateGoogleUser();
            }
        }
    </script>
    <!-- <script>
        let isAuth = false;
        const auth = document.getElementById('auth');
        function onSuccess(googleUser) {
            console.log('Logged in as: ' + googleUser.getBasicProfile().getName());
            auth.style.display = 'none';
        }
        function onFailure(error) {
            console.log(error);
            auth.style.display = 'block';
        }
        function renderButton() {
            gapi.signin2.render('my-signin2', {
                'scope': 'profile email',
                'width': 240,
                'height': 50,
                'longtitle': true,
                'theme': 'dark',
                'onsuccess': onSuccess,
                'onfailure': onFailure
            });
        }

        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
            });
        }
    </script> -->
    <script src="https://apis.google.com/js/platform.js?onload=appStart" async defer></script>
</body>

</html>